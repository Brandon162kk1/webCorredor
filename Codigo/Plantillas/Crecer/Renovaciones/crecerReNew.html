<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">

    <style>

        /* =========================
           CONFIGURACIÓN DE PÁGINA
        ========================= */

        @page {
            size: A4;
            margin: 130px 40px 120px 40px;

            @bottom-center {
                content: element(footer);
            }
        }

        /* Numeración automática */
        .paginacion::after {
            content: "Página " counter(page) " de " counter(pages);
        }

        /* =========================
           ESTILOS GENERALES
        ========================= */

        body {
            font-family: Arial, sans-serif;
            font-size: 12pt;
        }

        /* =========================
           HEADER FIJO
        ========================= */

        .header {
            position: fixed;
            top: -110px;
            left: 0;
            right: 0;
            height: 100px;
        }

            .header table {
                width: 100%;
                border-collapse: collapse;
            }

            .header td {
                border: none;
            }

        .encabezado-derecha {
            font-size: 12px;
            color: #7a7a7a;
            text-align: right;
            line-height: 1.4;
        }

        /* =========================
           FOOTER FIJO
        ========================= */

        .footer {
            position: running(footer);
        }

            .footer table {
                width: 100%;
                border-collapse: collapse;
            }

            .footer td {
                border: none;
                font-size: 12px;
            }

        /* =========================
           TABLAS
        ========================= */

        table {
            border-collapse: collapse;
            width: 100%;
            font-size: 14px;
        }

        th, td {
            border: 1px solid steelblue;
            padding: 6px 10px;
            text-align: center;
        }

        th {
            background-color: steelblue;
            color: white;
        }

        /* =========================
           BLOQUES TIPO INFO
        ========================= */

        .linea {
            display: table;
            width: 100%;
            font-family: monospace;
            margin-bottom: 4px;
        }

        .label, .colon, .value {
            display: table-cell;
            padding: 2px 4px;
        }

        .label {
            width: 240px;
            text-align: left;
        }

        .colon {
            width: 10px;
            text-align: center;
        }

        .value {
            text-align: left;
        }

        /* =========================
           FIRMAS
        ========================= */

        .firmas {
            width: 100%;
            table-layout: fixed;
            margin-top: 60px;
        }

            .firmas td {
                width: 33.33%;
                text-align: center;
                vertical-align: top;
                border: none;
            }

        .firma-img {
            height: 60px;
            object-fit: contain;
            margin-bottom: 5px;
        }

        .firma-linea {
            margin: 5px 0;
        }

        .firma-nombre, .firma-cargo {
            font-weight: bold;
            margin: 2px 0;
        }

        .espacio-firma {
            height: 60px;
            margin-bottom: 5px;
        }

        .fecha-derecha {
            text-align: right;
        }
    </style>
</head>

<body>

    <!-- =========================
         HEADER
    ========================= -->

    <div class="header">
        <table>
            <tr>
                <td style="width:40%;">
                    <img src="{{logo}}" width="150">
                </td>
                <td class="encabezado-derecha" style="width:60%;">
                    {{encabezado_logo | safe}}
                </td>
            </tr>
        </table>
    </div>

    <!-- =========================
         CONTENIDO
    ========================= -->

    <p class="fecha-derecha">{{fecha_texto}}</p>

    <center><p><strong>{{titulo_html}}</strong></p></center>
    <center><p><strong>{{subtitulo_html}}</strong></p></center>

    <div class="linea">
        <div class="label">PÓLIZA</div>
        <div class="colon">:</div>
        <div class="value">{{poliza}}</div>
    </div>

    <div class="linea">
        <div class="label">CONTRATANTE</div>
        <div class="colon">:</div>
        <div class="value">{{contratante}}</div>
    </div>

    <div class="linea">
        <div class="label">RUC</div>
        <div class="colon">:</div>
        <div class="value">{{ruc}}</div>
    </div>

    <div class="linea">
        <div class="label">TRÁMITE</div>
        <div class="colon">:</div>
        <div class="value">{{tramite}}</div>
    </div>

    <div class="linea">
        <div class="label">SEDE O LUGAR DE TRABAJO</div>
        <div class="colon">:</div>
        <div class="value">{{sede}}</div>
    </div>

    <p><strong>_______________________________________________________________________________________________</strong></p>

    <p>{{descripcion_html}} {{rango_fech}}.</p>

    <p><strong>ASEGURADOS:</strong></p>

    <table>
        <thead>
            <tr>
                <th>N°</th>
                <th>Apellido Paterno</th>
                <th>Apellido Materno</th>
                <th>Primer Nombre</th>
                <th>Segundo Nombre</th>
                <th>Nro. Documento</th>
            </tr>
        </thead>
        <tbody>
            {% for persona in datos_tabla %}
            <tr>
                <td>{{ persona['N°'] }}</td>
                <td>{{ persona['Ap. Paterno'] }}</td>
                <td>{{ persona['Ap. Materno'] }}</td>
                <td>{{ persona['Nombre 1'] }}</td>
                <td>{{ persona['Nombre 2'] }}</td>
                <td>
                    {% if persona['N° Documento']|string|length == 8 %}
                    DNI: {{ persona['N° Documento'] }}
                    {% else %}
                    CE: {{ persona['N° Documento'] }}
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <p style="margin-top: 30px;">Atentamente,</p>

    <table class="firmas">
        <tr>
            <td>
                <img src="{{firma_ger_op}}" class="firma-img">
                <p class="firma-linea">________________________</p>
                <p class="firma-nombre">LUIS E. ASMAT CUSTODIO</p>
                <p class="firma-cargo">Gerente de Operaciones</p>
                <p class="firma-cargo">CRECER SEGUROS</p>
            </td>
            <td>
                <img src="{{firma_vic}}" class="firma-img">
                <p class="firma-linea">________________________</p>
                <p class="firma-nombre">JUAN CARLOS ORDOÑEZ</p>
                <p class="firma-cargo">Vicepresidente Comercial</p>
                <p class="firma-cargo">CRECER SEGUROS</p>
            </td>
            <td>
                <div class="espacio-firma"></div>
                <p class="firma-linea">________________________</p>
                <p class="firma-nombre">CONTRATANTE</p>
            </td>
        </tr>
    </table>

    <!-- =========================
         FOOTER
    ========================= -->

    <div class="footer">
        <table>
            <tr>
                <td style="width:33%; text-align:left;">
                    <img src="{{img_footer}}" width="120">
                </td>
                <td style="width:34%; text-align:center;">
                    <span class="paginacion"></span>
                </td>
                <td style="width:33%; text-align:right;">
                    <img src="{{redes_footer}}" width="120">
                </td>
            </tr>
        </table>
    </div>

</body>
</html>
