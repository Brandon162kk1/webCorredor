<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">

    <style>

                /* ============================
           CONFIGURACIÓN DE PÁGINA
        ============================ */

                @page {
                    size: A4;
                    margin: 130px 40px 90px 40px;

                    @bottom-right {
                        content: "Página " counter(page) " de " counter(pages);
                        font-size: 11px;
                    }
                }

                /* ============================
           ESTILOS GENERALES
        ============================ */

                body {
                    font-family: Arial, sans-serif;
                    font-size: 12pt;
                }

                /* ============================
           HEADER FIJO
        ============================ */

                .header {
                    position: fixed;
                    top: -110px;
                    left: 0;
                    right: 0;
                    height: 100px;
                }

                    .header table {
                        width: 100%;
                        border-collapse: collapse;
                    }

                    .header td {
                        border: none;
                    }

                .encabezado-derecha {
                    font-size: 12px;
                    color: #7a7a7a;
                    text-align: right;
                    line-height: 1.4;
                }

                /* ============================
           TABLAS
        ============================ */

                table {
                    border-collapse: collapse;
                    width: 100%;
                    font-size: 14px;
                }

                th, td {
                    border: 1px solid black;
                    padding: 6px 10px;
                    text-align: center;
                }

                th {
                    background-color: steelblue;
                    color: white;
                }

                /* ============================
           BLOQUES TIPO INFO
        ============================ */

                .linea {
                    display: table;
                    width: 100%;
                    font-family: monospace;
                    margin-bottom: 4px;
                }

                .label, .colon, .value {
                    display: table-cell;
                    vertical-align: top;
                    padding: 2px 4px;
                }

                .label {
                    width: 240px;
                    text-align: left;
                }

                .colon {
                    width: 10px;
                    text-align: center;
                }

                .value {
                    text-align: left;
                }

                /* ============================
           FIRMAS
        ============================ */

                .firmas {
                    width: 100%;
                    table-layout: fixed;
                    margin-top: 60px;
                }

                    .firmas td {
                        width: 33.33%;
                        text-align: center;
                        vertical-align: top;
                        border: none;
                    }

                .firma-img {
                    height: 60px;
                    object-fit: contain;
                    margin-bottom: 5px;
                }

                .firma-linea {
                    margin: 5px 0;
                }

                .firma-nombre, .firma-cargo {
                    font-weight: bold;
                    margin: 2px 0;
                }

                .espacio-firma {
                    height: 60px;
                    margin-bottom: 5px;
                }
    </style>
</head>

<body>

    <!-- ============================
         HEADER (FIJO EN TODAS)
    ============================ -->

    <div class="header">
        <table>
            <tr>
                <td style="width:40%;">
                    <img src="{{logo}}" width="150">
                </td>
                <td class="encabezado-derecha" style="width:60%;">
                    {{encabezado_logo | safe}}
                </td>
            </tr>
        </table>
    </div>

    <!-- ============================
         CONTENIDO
    ============================ -->

    <p>{{fecha_texto}}</p>

    <center><p><strong>{{titulo_html}}</strong></p></center>
    <br>

    <div class="linea">
        <div class="label">POLIZA N°</div>
        <div class="colon">:</div>
        <div class="value">{{poliza}}</div>
    </div>

    <div class="linea">
        <div class="label">PRODUCTO</div>
        <div class="colon">:</div>
        <div class="value">{{producto}}</div>
    </div>

    <div class="linea">
        <div class="label">CONTRATANTE</div>
        <div class="colon">:</div>
        <div class="value">{{contratante}}</div>
    </div>

    <div class="linea">
        <div class="label">TRAMITE</div>
        <div class="colon">:</div>
        <div class="value">{{tramite}}</div>
    </div>

    <p><strong>_______________________________________________________________________________________________</strong></p>

    <p>{{descripcion_html}} {{rango_fech}}.</p>

    <p><strong>{{subtitulo_html}}</strong></p>

    <table>
        <thead>
            <tr>
                <th>Nro.</th>
                <th>Nombres</th>
                <th>Apellido Paterno</th>
                <th>Apellido Materno</th>
                <th>Nro. Documento</th>
            </tr>
        </thead>
        <tbody>
            {% for persona in datos_tabla %}
            <tr>
                <td>{{ persona['N°'] }}</td>
                <td>{{ persona['Nombres'] }}</td>
                <td>{{ persona['Ap. Paterno'] }}</td>
                <td>{{ persona['Ap. Materno'] }}</td>
                <td>
                    {% if persona['N° Documento']|string|length == 8 %}
                    DNI: {{ persona['N° Documento'] }}
                    {% else %}
                    CE: {{ persona['N° Documento'] }}
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <p style="margin-top: 30px;">Atentamente,</p>

    <!-- ============================
         FIRMAS
    ============================ -->

    <table class="firmas">
        <tr>
            <td>
                <img src="{{firma_ger_op}}" class="firma-img">
                <p class="firma-linea">________________________</p>
                <p class="firma-nombre">LUIS E. ASMAT CUSTODIO</p>
                <p class="firma-cargo">Gerente de Operaciones</p>
                <p class="firma-cargo">CRECER SEGUROS</p>
            </td>
            <td>
                <img src="{{firma_vic}}" class="firma-img">
                <p class="firma-linea">________________________</p>
                <p class="firma-nombre">JUAN CARLOS ORDOÑEZ</p>
                <p class="firma-cargo">Vicepresidente Comercial</p>
                <p class="firma-cargo">CRECER SEGUROS</p>
            </td>
            <td>
                <div class="espacio-firma"></div>
                <p class="firma-linea">________________________</p>
                <p class="firma-nombre">CONTRATANTE</p>
            </td>
        </tr>
    </table>

</body>
</html>
